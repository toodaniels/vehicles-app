(this["webpackJsonpvehicles-app"]=this["webpackJsonpvehicles-app"]||[]).push([[0],{43:function(e,a,t){e.exports=t(56)},49:function(e,a,t){},56:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(19),l=t.n(c),s=t(11),i=r.a.createContext(),o=t(10),u=t.n(o),m=(t(49),t(6)),p=t.n(m),d=t(9),f=t(18);var v=function(e){var a=e.type,t=e.name,n=e.placeholder,c=e.onChange,l=e.onBlur,s=e.value,i=e.error,o=e.touched,u=(e.message,i&&o?"form-control is-invalid":s&&o?"form-control is-valid":"form-control");return r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("input",{className:u,placeholder:n,type:a,name:t,onChange:c,onBlur:l,value:s,required:!0}),r.a.createElement("div",{className:"invalid-feedback"},i))},h=function(e){var a={},t=e.email,n=e.name,r=e.password,c=e.repeatPassword;return t?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(e.email)||(a.email="Invalid email address"):a.email="Correo es requerido",n||(a.name="Nombre es requerido"),r||(a.password="Contrase\xf1a es requerida"),c?r!==c&&(a.repeatPassword="La contrase\xf1a no coincide"):a.repeatPassword="La contrase\xf1a no coincide",a},b=t(34),E="https://vehicles-engineering-project.herokuapp.com",g=function(){var e=Object(d.a)(p.a.mark((function e(a,t){var n,r,c,l,s,i=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>2&&void 0!==i[2]?i[2]:{},r=i.length>3?i[3]:void 0,c={},e.prev=3,l={method:t},["POST","PUT"].includes(t)&&(c["Content-Type"]="application/json",l=Object(b.a)({},l,{body:JSON.stringify(n)})),u.a.isEmpty(r)||(c.Authorization="Bearer ".concat(r)),l=Object(b.a)({},l,{headers:c}),e.next=10,fetch(E+a,l);case 10:return s=e.sent,e.abrupt("return",s);case 14:return e.prev=14,e.t0=e.catch(3),e.abrupt("return",e.t0);case 17:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(a,t){return e.apply(this,arguments)}}(),w=function(){var e=Object(d.a)(p.a.mark((function e(a,t,n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g("/api/v1/signup","POST",{email:a,name:t,password:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(a,t,n){return e.apply(this,arguments)}}(),y=function(){var e=Object(d.a)(p.a.mark((function e(a,t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g("/api/v1/signin","POST",{email:a,password:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(a,t){return e.apply(this,arguments)}}(),N=function(){var e=Object(d.a)(p.a.mark((function e(a,t,n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g("/api/v1/auth/vehicles","POST",{plate:a,location:t},n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(a,t,n){return e.apply(this,arguments)}}(),O=function(){var e=Object(d.a)(p.a.mark((function e(a){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g("/api/v1/auth/vehicles","GET",null,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),x=function(){var e=Object(d.a)(p.a.mark((function e(a,t,n,r){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g("/api/v1/auth/vehicles"+"/".concat(a),"PUT",{plate:t,location:n},r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(a,t,n,r){return e.apply(this,arguments)}}(),j=function(){var e=Object(d.a)(p.a.mark((function e(a,t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g("/api/v1/auth/vehicles"+"/".concat(a),"DELETE",null,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(a,t){return e.apply(this,arguments)}}();var S=function(e){var a=function(){var a=Object(d.a)(p.a.mark((function a(t,n){var r,c,l,s,i,o,u;return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=n.setSubmitting,c=t.email,l=t.name,s=t.password,i=e.gotoLogin,o=e.setAlertData,a.next=5,w(c,l,s);case 5:return u=a.sent,r(!1),o("alert-success","Te registraste correctamente!"),i(),a.abrupt("return",u);case 10:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}();return r.a.createElement(f.a,{initialValues:{email:"",password:"",name:"",repeatPassword:""},validate:h,onSubmit:a},(function(e){var a=e.values,t=e.errors,n=e.touched,c=e.handleChange,l=e.handleBlur,s=e.handleSubmit,i=e.isSubmitting;return r.a.createElement("div",{className:"login"},r.a.createElement("form",{onSubmit:s},r.a.createElement("h3",null," Registrarse "),r.a.createElement(v,{type:"email",name:"email",placeholder:"Correo",onChange:c,onBlur:l,value:a.email,error:t.email,touched:n.email}),r.a.createElement(v,{type:"text",name:"name",placeholder:"Nombre",onChange:c,onBlur:l,value:a.name,error:t.name,touched:n.name}),r.a.createElement(v,{type:"password",name:"password",placeholder:"Contrase\xf1a",onChange:c,onBlur:l,value:a.password,error:t.password,touched:n.password}),r.a.createElement(v,{type:"password",name:"repeatPassword",placeholder:"Repetir Contrase\xf1a",onChange:c,onBlur:l,value:a.repeatPassword,error:t.repeatPassword,touched:n.repeatPassword}),r.a.createElement("button",{type:"submit",disabled:i},r.a.createElement("div",null,"Registrarme"))))}))},C=function(e){var a={},t=e.email,n=e.password;return t?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(e.email)||(a.email="Invalid email address"):a.email="Correo es requerido",n||(a.password="Contrase\xf1a es requerida"),a};var k=function(e){var a=function(){var a=Object(d.a)(p.a.mark((function a(t,n){var r,c,l,s,i,o,u,m;return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=n.setSubmitting,c=t.email,l=t.password,s=e.setAlertData,i=e.onLogin,a.next=5,y(c,l);case 5:if(200===(o=a.sent).status){a.next=13;break}return a.next=9,o.json();case 9:u=a.sent,s("alert-danger",u),a.next=17;break;case 13:return a.next=15,o.json();case 15:m=a.sent,i(m);case 17:r(!1);case 18:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}();return r.a.createElement(f.a,{initialValues:{email:"",password:""},validate:C,onSubmit:a},(function(e){var a=e.values,t=e.errors,n=e.touched,c=e.handleChange,l=e.handleBlur,s=e.handleSubmit,i=e.isSubmitting;return r.a.createElement("div",{className:"login"},r.a.createElement("form",{onSubmit:s},r.a.createElement("h3",null,"Vehicles"),r.a.createElement(v,{type:"email",name:"email",placeholder:"Correo",onChange:c,onBlur:l,value:a.email,error:t.email,touched:n.email}),r.a.createElement(v,{type:"password",name:"password",placeholder:"Contrase\xf1a",onChange:c,onBlur:l,value:a.password,error:t.password,touched:n.password}),r.a.createElement("button",{type:"submit",disabled:i},r.a.createElement("div",null,"Ingresar"))))}))},A=t(28),P=t.n(A);var V=function(e){var a=e.type,t=e.message;return r.a.createElement("div",{className:P()("alert",a),role:"alert"},t)};var B=function(e){var a=Object(n.useContext)(i),t=Object(n.useState)(!1),c=Object(s.a)(t,2),l=c[0],o=c[1],m=Object(n.useState)(""),p=Object(s.a)(m,2),d=p[0],f=p[1],v=Object(n.useState)(""),h=Object(s.a)(v,2),b=h[0],E=h[1],g=function(){o(!l)},w=function(e,a){f(a),E(e)};return r.a.createElement("aside",null,u.a.isEmpty(a.user)?r.a.createElement(r.a.Fragment,null,l?r.a.createElement(S,{gotoLogin:g,setAlertData:w}):r.a.createElement(k,{gotoRegister:g,setAlertData:w,onLogin:function(e){a.setUser(e)}}),r.a.createElement("div",{className:"link",onClick:g,href:""},l?"Regresar":"Registarme"),r.a.createElement(V,{type:b,message:d})):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"instructions"},r.a.createElement("div",{className:"float",onClick:function(){e.closeAside()}},r.a.createElement("i",{className:"fas fa-times my-float"})),r.a.createElement("h3",null,"Bienvenido!"),r.a.createElement("h5",null,"Crea nuevos vehiculos"),r.a.createElement("ol",null,r.a.createElement("li",null,"Presiona el boton:",r.a.createElement("div",{className:"float-button popup-button"},r.a.createElement("i",{className:"fas fa-car"})," ",r.a.createElement("i",{className:"fas fa-plus-circle float-second-icon"}))),r.a.createElement("li",null,"Arrastra el:",r.a.createElement("img",{className:"icon",src:"https://img.icons8.com/officel/2x/car.png",width:38,height:40,alt:"car icon"}),"para asignarle su nueva localizaci\xf3n."),r.a.createElement("li",null,"Asigna un n\xfamero de placa y presiona:",r.a.createElement("div",{className:"float-button popup-button"},r.a.createElement("i",{className:"fas fa-save"})),"para guardar los cambios")),r.a.createElement("h5",null,"Actualiza y elimina vehiculos"),r.a.createElement("ol",null,r.a.createElement("li",null,"Presiona o arrastra los:",r.a.createElement("img",{className:"icon",src:"https://img.icons8.com/plasticine/2x/car.png",width:38,height:40,alt:"car icon"})),r.a.createElement("li",null,"Asigna un nuevo n\xfamero de placa o localizaci\xf3n y presiona:",r.a.createElement("div",{className:"float-button popup-button"},r.a.createElement("i",{className:"fas fa-save"})),"para guardar los cambios"),r.a.createElement("li",null,"Presiona el:",r.a.createElement("div",{className:"float-button popup-button"},r.a.createElement("i",{className:"fas fa-trash"})),"para eliminar el vehiculo")),r.a.createElement("div",null))))},L=t(33),D=t.n(L),q=t(37),U=t(40),z=t(2),J=t.n(z),T=t(38),I=t(39),R=function(e){var a={};return e.plate||(a.plate="La placa es requerida es requerida"),a};var Z=function(e){var a=Object(n.useContext)(i),t=function(){var t=Object(d.a)(p.a.mark((function t(n,r){var c,l,s,i,o;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.setSubmitting,l=n.plate,s=e.location,i=e.onVehicleCreated,o=e.setAlertData,t.next=5,N(l,s,a.user.token);case 5:if(201===t.sent.status){t.next=9;break}return o("Ya existe esa placa"),t.abrupt("return");case 9:o(""),c(!1),i(!0);case 12:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}();return r.a.createElement(f.a,{initialValues:{plate:""},validate:R,onSubmit:t},(function(a){var t=a.values,n=a.errors,c=a.touched,l=a.handleChange,s=a.handleBlur,i=a.handleSubmit,o=a.isSubmitting;return r.a.createElement("form",{onSubmit:i},r.a.createElement("h5",null,"Creando nuevo vehiculo"),r.a.createElement(v,{type:"text",name:"plate",placeholder:"Placa",onChange:l,onBlur:s,value:t.plate,error:n.plate,touched:c.plate}),r.a.createElement("div",null,"Location : ",JSON.stringify(e.location)),r.a.createElement("button",{type:"submit",className:"popup-button",disabled:o||u.a.isEmpty(t.plate)||u.a.isEmpty(e.location)},r.a.createElement("i",{className:"fas fa-save"})),r.a.createElement("div",{className:"float-button popup-button",onClick:function(){e.onVehicleCreated(!1)}},r.a.createElement("i",{className:"fas fa-times float-second-icon"})))}))};var _=function(e){var a=Object(n.useState)(e.initPosition),t=Object(s.a)(a,2),c=t[0],l=t[1],i=Object(n.useState)(""),o=Object(s.a)(i,2),m=o[0],p=o[1];return r.a.createElement(T.a,{position:e.initPosition,draggable:!0,ondragend:function(e){var a=e.target._latlng,t=a.lat,n=a.lng;l([t,n])},icon:J.a.icon({iconUrl:"https://img.icons8.com/officel/2x/car.png",iconSize:[38,40]})},r.a.createElement(I.a,null,r.a.createElement(Z,{location:c,initialLocation:e.initPosition,onVehicleCreated:e.onVehicleCreated,setAlertData:p}),!u.a.isEmpty(m)&&r.a.createElement("div",{className:"alert alert-danger",role:"alert"},JSON.stringify(m))))},$=function(e){var a={};return e.plate||(a.plate="La placa es requerida es requerida"),a};var F=function(e){var a=Object(n.useContext)(i),t={plate:e.plate},c=function(){var t=Object(d.a)(p.a.mark((function t(n,r){var c,l,s,i,o;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.setSubmitting,l=n.plate,s=e.location,i=e.onVehicleUpdated,o=e.setAlertData,t.next=5,x(e.plate,l,s,a.user.token);case 5:if(204===t.sent.status){t.next=9;break}return o("Ya existe esa placa"),t.abrupt("return");case 9:o(""),c(!1),i(!0);case 12:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),l=function(){var t=Object(d.a)(p.a.mark((function t(){var n,r,c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.onVehicleDeleted,r=e.setAlertData,c=e.plate,t.next=3,j(c,a.user.token);case 3:if(204===t.sent.status){t.next=7;break}return r("Ocurri\xf3 un error"),t.abrupt("return");case 7:r(""),n(!0);case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return r.a.createElement(f.a,{initialValues:t,validate:$,onSubmit:c},(function(a){var t=a.values,n=a.errors,c=a.touched,s=a.handleChange,i=a.handleBlur,o=a.handleSubmit,m=a.isSubmitting;return r.a.createElement("form",{onSubmit:o},r.a.createElement("h5",null,"Actualizar vehiculo"),r.a.createElement(v,{type:"text",name:"plate",placeholder:"Placa",onChange:s,onBlur:i,value:t.plate,error:n.plate,touched:c.plate}),r.a.createElement("div",null,"Locaci\xf3n  Actual: ",JSON.stringify(e.location),r.a.createElement("div",null),"Locaci\xf3n  Inicial: ",JSON.stringify(e.initialLocation)),r.a.createElement("button",{type:"submit",className:"popup-button",disabled:m||u.a.isEqual(e.location,e.initialLocation)&&u.a.isEqual(t.plate,e.plate)},r.a.createElement("i",{className:"fas fa-save"})),r.a.createElement("div",{className:"float-button popup-button",onClick:l},r.a.createElement("i",{className:"fas fa-trash float-second-icon"})))}))};var M=function(e){var a=e.vehicle,t=Object(n.useState)(a.location.coordinates),c=Object(s.a)(t,2),l=c[0],i=c[1],o=Object(n.useState)(""),m=Object(s.a)(o,2),p=m[0],d=m[1];return r.a.createElement(T.a,{position:a.location.coordinates,draggable:!0,ondragend:function(e){var a=e.target._latlng,t=a.lat,n=a.lng;i([t,n])},icon:J.a.icon({iconUrl:"https://img.icons8.com/plasticine/2x/car.png",iconSize:[38,40]})},r.a.createElement(I.a,null,r.a.createElement(F,{location:l,initialLocation:a.location.coordinates,plate:a.plate,onVehicleUpdated:e.onVehicleUpdated,onVehicleDeleted:e.onVehicleDeleted,setAlertData:d}),!u.a.isEmpty(p)&&r.a.createElement("div",{className:"alert alert-danger",role:"alert"},JSON.stringify(p))))},W=[19.432608,-99.133209],Y=function(e){var a=e.vehicles,t=e.updateVehicles,c=Object(n.useState)(!1),l=Object(s.a)(c,2),i=l[0],o=l[1],m=Object(n.useState)(""),p=Object(s.a)(m,2),d=p[0],f=p[1],v=function(e){t(),e&&f("Actualizado Correctamente")},h=function(e){t(),e&&f("Eliminado Correctamente")};return r.a.createElement("div",{className:"map"},r.a.createElement(q.a,{center:W,zoom:13},r.a.createElement(U.a,{url:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png",attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}),i&&r.a.createElement(_,{initPosition:W,onVehicleCreated:function(e){o(!1),t(),e&&f("Creado Correctamente")}}),a.map((function(e){return r.a.createElement(M,{key:e._id,vehicle:e,onVehicleUpdated:v,onVehicleDeleted:h})})),r.a.createElement(D.a,{position:"topright"},r.a.createElement("div",{className:"float-button-group",onClick:function(){return o(!0)}},r.a.createElement("div",{className:"float-button"},r.a.createElement("i",{className:"fas fa-car"})," ",r.a.createElement("i",{className:"fas fa-plus-circle float-second-icon"})))),r.a.createElement(D.a,{position:"bottomright"},!u.a.isEmpty(d)&&r.a.createElement("div",{className:"alert alert-success",role:"alert"},d," ",r.a.createElement("i",{className:"fas fa-times",onClick:function(){f("")}})))))};var G=function(e){var a=Object(n.useContext)(i),t=Object(n.useState)([]),c=Object(s.a)(t,2),l=c[0],o=c[1],u=function(){var e=Object(d.a)(p.a.mark((function e(){var t,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(a.user.token);case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,o(n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){(function(){var e=Object(d.a)(p.a.mark((function e(){var t,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(a.user.token);case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,o(n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[a.user.token]);var m=e.showAside,f=["home"];return m&&f.push("home-margin"),r.a.createElement("div",{className:P()(f)},r.a.createElement("nav",{className:"navbar"},r.a.createElement("div",{className:"navbar-brand",onClick:function(){e.openAside()}},r.a.createElement("div",null,m?r.a.createElement("i",{className:"fa fa-times"}):r.a.createElement("i",{className:"far fa-question-circle"})," Vehiculos")),r.a.createElement("div",{className:"logout",onClick:function(){a.setUser({})}},r.a.createElement("i",{className:"fas fa-car-side"})," ",a.user.email," ",r.a.createElement("i",{className:"fas fa-sign-out-alt"}))),r.a.createElement(Y,{vehicles:l,updateVehicles:u}))};var H=function(){var e=Object(n.useState)(JSON.parse(localStorage.getItem("user"))),a=Object(s.a)(e,2),t=a[0],c=a[1],l=Object(n.useState)(!1),o=Object(s.a)(l,2),m=o[0],p=o[1],d={user:t,setUser:function(e){c(e),localStorage.setItem("user",JSON.stringify(e))}};return r.a.createElement(i.Provider,{value:d},r.a.createElement("div",{className:"float",onClick:function(){p(!0)}},r.a.createElement("i",{className:"fas fa-bars my-float"})),(m||u.a.isEmpty(t))&&r.a.createElement(B,{closeAside:function(){p(!1)}}),u.a.isEmpty(t)?r.a.createElement("div",{className:"home empty"}):r.a.createElement(G,{showAside:m,openAside:function(){p(!m)}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));t(55);l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(H,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[43,1,2]]]);
//# sourceMappingURL=main.6d6c7fa6.chunk.js.map